import{a as ue,b as ge,c as be,d as Y}from"./chunk-TZ5NYXRZ.js";import{a as R}from"./chunk-K5LJX3T7.js";import{a as B}from"./chunk-DQGUWOJX.js";import{b as te,c as ie,f as P,j as L,p as ne,q as oe,r as re,v as j}from"./chunk-D4KUVVV6.js";import{B as T,Ba as G,C as k,Cb as pe,Fa as V,Ga as K,Gb as _e,H as f,Ha as Q,I as u,Qa as Z,Ra as $,Sa as A,Sb as W,T as o,Ta as F,U as I,Ua as ee,Ub as fe,Va as N,Wb as D,Xb as X,Y as _,_ as s,ba as M,fa as a,ga as r,ha as p,hb as q,ia as v,ja as x,jb as O,ka as d,mb as ae,ra as l,rb as se,sa as h,ta as S,tb as le,ua as U,vb as ce,wa as J,x as E,xa as y,xb as me,ya as C,yb as de,za as b}from"./chunk-IEDQEACJ.js";import{f as Ce}from"./chunk-GAL4ENT6.js";var xe=Ce(be());function Te(t,c){if(t&1&&p(0,"fa-icon",15),t&2){let e=d();s("icon",e.faCircleNotch)}}function ke(t,c){if(t&1&&p(0,"fa-icon",16),t&2){let e=d();s("icon",e.faPaperPlane)}}function Ie(t,c){if(t&1&&(a(0,"div",17)(1,"span",18),l(2),K(3,"date"),r(),p(4,"br"),a(5,"span",19),l(6),r()()),t&2){let e=c.$implicit;o(2),h(Q(3,2,e.created_at,"MMM dd, yyyy HH:mm a")),o(4),h(e.message)}}function Ue(t,c){t&1&&(a(0,"div",20),l(1," No Previous SMS Logged "),r())}var H=(()=>{class t{sendSMS(){if(this.message&&this.message!==""){this.is_saving=!0;let e={message:this.message,contact_number:this.selected_user.contact_number};this.http.post("send-sms",e).subscribe({next:n=>{console.log(n),this.is_saving=!1},error:n=>console.log(n)})}}getSegmentCount(e){return Math.ceil(e/160)}constructor(e){this.http=e,this.faPaperPlane=W,this.faCircleNotch=O,this.is_saving=!1}ngOnInit(){console.log(this.selected_user)}static{this.\u0275fac=function(n){return new(n||t)(I(B))}}static{this.\u0275cmp=T({type:t,selectors:[["app-messaging-sms"]],inputs:{selected_user:"selected_user"},standalone:!0,features:[G],decls:22,vars:8,consts:[[1,"p-3","bg-white"],[1,"flex","flex-col"],[1,"flex","justify-center"],[1,"flex","flex-col","w-3/5","shadow-md","p-3","rounded-md","border","border-gray-300","my-5","bg-slate-50"],["rows","4",1,"input-txt",3,"ngModelChange","ngModel"],[1,"flex","justify-end","mb-5"],[1,"pb-5"],[1,"flex","justify-end"],[1,"btn-blue",3,"click","disabled"],["animation","spin","class","mr-1",3,"icon",4,"ngIf"],["class","mr-1",3,"icon",4,"ngIf"],[1,"flex","flex-col","mx-20","border","border-gray-200","rounded-lg","mb-10"],[1,"font-semibold","p-3"],["class","px-3 py-2 border-t border-gray-100 mb-3",4,"ngFor","ngForOf"],["class","flex justify-center italic text-center mb-3",4,"ngIf"],["animation","spin",1,"mr-1",3,"icon"],[1,"mr-1",3,"icon"],[1,"px-3","py-2","border-t","border-gray-100","mb-3"],[1,"text-xs"],[1,"font-semibold","ml-5"],[1,"flex","justify-center","italic","text-center","mb-3"]],template:function(n,i){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"div")(6,"label"),l(7,"Message Content"),r(),a(8,"textarea",4),b("ngModelChange",function(w){return C(i.message,w)||(i.message=w),w}),r()(),a(9,"div",5),l(10),r()(),a(11,"div",6)(12,"div",7)(13,"button",8),x("click",function(){return i.sendSMS()}),_(14,Te,1,1,"fa-icon",9)(15,ke,1,1,"fa-icon",10),l(16," Send "),r()()()()(),a(17,"div",11)(18,"div",12),l(19," SMS logs "),r(),_(20,Ie,7,5,"div",13)(21,Ue,2,0,"div",14),r()()()),n&2&&(o(8),y("ngModel",i.message),o(2),U(" ",i.message?i.message.length:0,"/",i.message?i.getSegmentCount(i.message.length):1," "),o(3),s("disabled",i.is_saving||!i.message&&i.message!==""),o(),s("ngIf",i.is_saving),o(),s("ngIf",!i.is_saving),o(5),s("ngForOf",i.selected_user.sms_logs),o(),s("ngIf",(i.selected_user==null||i.selected_user.sms_logs==null?null:i.selected_user.sms_logs.length)===0))},dependencies:[j,ie,P,L,N,A,F,ee,X,D]})}}return t})();var Ae=(t,c,e)=>({"bg-orange-100 hover:bg-orange-200":t,"bg-red-200 hover:bg-red-300":c,"hover:bg-sky-100":e}),ve=(t,c,e)=>({"bg-orange-500":t,"bg-green-500":c,"bg-red-500":e});function Fe(t,c){if(t&1){let e=v();a(0,"span",13)(1,"button",14),x("click",function(){f(e);let i=d();return u(i.toggleModal("closeAll"))}),p(2,"fa-icon",15),r()()}if(t&2){let e=d();o(2),s("icon",e.faArrowLeft)}}function Ne(t,c){if(t&1){let e=v();a(0,"div")(1,"button",16),x("click",function(){f(e);let i=d();return u(i.getAllData())}),p(2,"fa-icon",15),r()()}if(t&2){let e=d();o(2),s("icon",e.faFileExcel)}}function Pe(t,c){if(t&1&&(a(0,"option",38),l(1),r()),t&2){let e=c.$implicit;s("value",e),o(),h(e)}}function Le(t,c){if(t&1&&(a(0,"option",38),l(1),r()),t&2){let e=c.$implicit;s("value",e),o(),h(e)}}function je(t,c){if(t&1&&(a(0,"option",38),l(1),r()),t&2){let e=c.$implicit;s("value",e),o(),h(e)}}function Oe(t,c){t&1&&l(0," Unverified ")}function We(t,c){t&1&&l(0," Rejected ")}function De(t,c){t&1&&l(0," Verified ")}function Xe(t,c){if(t&1){let e=v();a(0,"tr",40)(1,"td",25)(2,"button",41),x("click",function(){let i=f(e).$implicit,m=d(3);return u(m.toggleModal("user-information",i))}),a(3,"span",42),l(4),r()(),l(5),r(),a(6,"td",43),l(7),p(8,"br"),a(9,"span",44),l(10),p(11,"br"),l(12),p(13,"br"),l(14," \xA0 "),r()(),a(15,"td",45)(16,"span",46),p(17,"fa-icon",47),_(18,Oe,1,0)(19,We,1,0)(20,De,1,0),r()(),a(21,"td",45)(22,"button",48),x("click",function(){let i=f(e).$implicit,m=d(3);return u(m.toggleModal("show-sms",i))}),l(23," SMS "),p(24,"fa-icon",49),r()(),a(25,"td",45)(26,"label",50)(27,"input",51),b("ngModelChange",function(i){let m=f(e).$implicit;return C(m.is_active,i)||(m.is_active=i),u(i)}),x("click",function(){let i=f(e).$implicit,m=d(3);return u(m.toggleActive(i))}),r(),p(28,"div",52),r()()()}if(t&2){let e=c.$implicit,n=d(3);s("ngClass",V(18,Ae,e.user_verified===null,e.user_verified===0,e.user_verified===1)),o(4),U("",e.first_name[0],"",e.last_name[0],""),o(),J(" ",e.first_name," ",e.middle_name," ",e.suffix_name!=="NA"?e.suffix_name:""," ",e.last_name," "),o(2),S(" ",e.school.desc," "),o(3),S(" ",e.email," "),o(2),S(" ",e.contact_number," "),o(4),s("ngClass",V(22,ve,!e.user_verified,e.user_verified===1,e.user_verified===0)),o(),s("icon",e.user_verified?e.user_verified===1?n.faCircleCheck:n.faXmarkCircle:n.faClock),o(),M(e.user_verified===null?18:-1),o(),M(e.user_verified===0?19:-1),o(),M(e.user_verified===1?20:-1),o(4),s("icon",n.faPaperPlane),o(3),s("disabled",!e.user_verified),y("ngModel",e.is_active)}}function Be(t,c){t&1&&(a(0,"tr")(1,"td",53),l(2,"No records found..."),r()())}function Re(t,c){if(t&1&&(a(0,"tbody"),_(1,Xe,29,26,"tr",39)(2,Be,3,0,"tr",7),r()),t&2){let e=d(2);o(),s("ngForOf",e.userList),o(),s("ngIf",e.userList.length===0)}}function Ye(t,c){if(t&1&&(a(0,"div",54)(1,"div",55),p(2,"fa-icon",56),r(),a(3,"div",57),l(4," Loading list... "),r()()),t&2){let e=d(2);o(2),s("icon",e.faCircleNotch)}}function He(t,c){if(t&1){let e=v();a(0,"app-page-controller",58),x("movePage",function(i){f(e);let m=d(2);return u(m.loadList(i))}),r()}if(t&2){let e=d(2);s("meta",e.meta)}}function qe(t,c){if(t&1){let e=v();a(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"span",21),l(5,"Email Type"),r(),a(6,"select",22),b("ngModelChange",function(i){f(e);let m=d();return C(m.emailType,i)||(m.emailType=i),u(i)}),a(7,"option",23),l(8,"All"),r(),_(9,Pe,2,2,"option",24),r()(),a(10,"div",20)(11,"span",21),l(12,"Category"),r(),a(13,"select",22),b("ngModelChange",function(i){f(e);let m=d();return C(m.is_verified,i)||(m.is_verified=i),u(i)}),a(14,"option",23),l(15,"All"),r(),_(16,Le,2,2,"option",24),r()(),a(17,"div",25)(18,"span",21),l(19,"Active Status"),r(),a(20,"select",22),b("ngModelChange",function(i){f(e);let m=d();return C(m.active_status,i)||(m.active_status=i),u(i)}),a(21,"option",23),l(22,"All"),r(),_(23,je,2,2,"option",24),r()(),a(24,"div",26)(25,"button",27),x("click",function(){f(e);let i=d();return u(i.loadList())}),p(26,"fa-icon",28),a(27,"span",29),l(28,"Apply"),r()()()()(),a(29,"div",30)(30,"table",31)(31,"thead")(32,"tr",29)(33,"th",32),l(34,"Name"),r(),a(35,"th",32),l(36,"Details"),r(),a(37,"th",33),l(38,"Status"),r(),a(39,"th",34),l(40,"Action"),r(),a(41,"th",35),l(42,"Active Status"),r()()(),_(43,Re,3,2,"tbody",7),r(),_(44,Ye,5,1,"div",36),r(),_(45,He,1,1,"app-page-controller",37),r()}if(t&2){let e=d();o(6),y("ngModel",e.emailType),o(),s("ngValue",null),o(2),s("ngForOf",e.studentEmailList),o(4),y("ngModel",e.is_verified),o(),s("ngValue",null),o(2),s("ngForOf",e.category),o(4),y("ngModel",e.active_status),o(),s("ngValue",null),o(2),s("ngForOf",e.activeStatus),o(3),s("icon",e.faFilter),o(17),s("ngIf",!e.isLoading),o(),s("ngIf",e.isLoading),o(),s("ngIf",e.userList.length>0)}}function ze(t,c){if(t&1&&(a(0,"div",10)(1,"span",59),p(2,"fa-icon",15),l(3),r()()),t&2){let e=d();o(),s("ngClass",V(3,ve,e.selected_user.user_verified===null,e.selected_user.user_verified===1,e.selected_user.user_verified===0)),o(),s("icon",e.selected_user.user_verified===null?e.faClock:e.selected_user.user_verified===1?e.faCircleCheck:e.faXmarkCircle),o(),S(" ",e.selected_user.user_verified===null?"Pending":e.selected_user.user_verified===1?"Verified":"Rejected"," ")}}function Je(t,c){if(t&1&&p(0,"app-messaging-sms",60),t&2){let e=d();s("selected_user",e.selected_user)}}function Ge(t,c){if(t&1&&p(0,"app-user-information",60),t&2){let e=d();s("selected_user",e.selected_user)}}function Ke(t,c){if(t&1&&p(0,"fa-icon",56),t&2){let e=d(2);s("icon",e.faCircleNotch)}}function Qe(t,c){if(t&1&&p(0,"fa-icon",56),t&2){let e=d(2);s("icon",e.faCircleNotch)}}function Ze(t,c){if(t&1){let e=v();a(0,"div",12)(1,"button",61),x("click",function(){f(e);let i=d();return u(i.verifyUser(!1))}),_(2,Ke,1,1,"fa-icon",62),l(3," Reject "),r(),a(4,"button",63),x("click",function(){f(e);let i=d();return u(i.verifyUser(!0))}),_(5,Qe,1,1,"fa-icon",62),l(6," Verify "),r()()}if(t&2){let e=d();o(),s("disabled",e.updating_user),o(),s("ngIf",e.updating_user),o(2),s("disabled",e.updating_user),o(),s("ngIf",e.updating_user)}}var he=(()=>{class t{loadList(e){this.isLoading=!0;let n={};n.page=e??1,n.user_info=1,this.active_status&&(n.active_status=this.active_status),this.emailType&&(n.email_used=this.emailType),this.is_verified&&(n.is_verified=this.is_verified),this.lib_cat_id&&(n.lib_cat_id=this.lib_cat_id),this.start_date&&(n.start_date=this.start_date),this.end_date&&(n.end_date=this.end_date),this.http.get("user-information",{params:n}).subscribe({next:i=>{console.log(i),this.userList=i.data,this.meta=i.meta,this.isLoading=!1},error:i=>console.log(i)})}toggleActive(e){e.is_active=!e.is_active,this.http.update("user-information/",e.id,e).subscribe({next:()=>console.log("updated successfully"),error:n=>console.log(n)})}toggleModal(e,n){this.selected_user=n,e==="closeAll"?(this.modals["user-information"]=!1,this.modals["show-sms"]=!1):(console.log(this.selected_user),this.modals[e]=!this.modals[e])}verifyUser(e){this.updating_user=!0,this.selected_user.user_verified=e===!0?1:0,this.selected_user.is_active=e===!0?1:0,this.http.update("user-information/",this.selected_user.id,this.selected_user).subscribe({next:n=>{console.log(this.selected_user),this.updating_user=!1},error:n=>console.log(n)})}getAllData(){let e={};e.user_info=1,e.per_page=20,this.active_status&&(e.active_status=this.active_status),this.is_verified&&(e.is_verified=this.is_verified),this.lib_cat_id&&(e.lib_cat_id=this.lib_cat_id),this.start_date&&(e.start_date=this.start_date),this.end_date&&(e.end_date=this.end_date),this.allApplicantArray=[];let n=i=>{e.page=i,this.http.get("user-information",{params:e}).subscribe({next:m=>{console.log(m);let w=m.data.map(g=>({last_name:g.last_name,first_name:g.first_name,email:g.email,contact_number:g.contact_number,is_scholar:g.scholar_flag?"Yes":"No",is_irregular:g.irregular_flag?"Yes":"No",is_shiftee:g.shiftee_flag?"Yes":"No",is_parent_ofw:g.parents.ofw_flag?"Yes":"No",course:g.academic_program.desc,year_level:g.year_level.desc,school:g.school.desc,verified_account:g.user_verified?"Yes":"No",active_account:g.is_active?"Yes":"No"}));this.allApplicantArray.push(...w),i<m.meta.last_page?n(i+1):this.exportToExcel(this.allApplicantArray)},error:m=>console.log(m)})};n(1)}exportToExcel(e){let i={Sheets:{data:ge.json_to_sheet(e)},SheetNames:["data"]},m=ue(i,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(m,"user_list")}saveAsExcelFile(e,n){let i="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",m=new Blob([e],{type:i});(0,xe.saveAs)(m,`${n}.xlsx`)}constructor(e){this.http=e,this.faPenToSquare=ae,this.faTableColumns=se,this.faFilter=ce,this.faCircleNotch=O,this.faArrowLeft=pe,this.faCircleCheck=le,this.faXmarkCircle=fe,this.faClock=_e,this.faArrowRight=de,this.faPaperPlane=W,this.faFileExcel=me,this.userList=[],this.active_status=!1,this.category=["pending","verified","rejected"],this.activeStatus=["active","inactive"],this.studentEmailList=["school","personal"],this.scholarPartTime=[{id:2,title:"Scholarship"},{id:1,title:"Part-time Jobs"}],this.max_date=Z(new Date,"yyyy-MM-dd","en","Asia/manila"),this.isLoading=!1,this.modals=[],this.updating_user=!1}ngOnInit(){this.loadList()}static{this.\u0275fac=function(n){return new(n||t)(I(B))}}static{this.\u0275cmp=T({type:t,selectors:[["app-manage-user"]],decls:18,vars:7,consts:[[1,"flex","flex-col","w-full","px-5","overflow-y-auto"],[1,"flex","flex-col","mt-5","min-h-screen"],[1,"flex","justify-between"],[1,"flex","justify-between","w-full"],["class","text-blue-600",4,"ngIf"],[1,"font-semibold","text-xl"],[1,"text-sm","font-normal"],[4,"ngIf"],["class","bg-white select-none",4,"ngIf"],[1,"flex","flex-col"],[1,"flex","justify-end","bg-white","rounded-md","-mb-3","p-3"],[3,"selected_user",4,"ngIf"],[1,"flex","justify-center","bg-white","rounded-md","shadow-md","my-3","py-3","px-3","-mt-3"],[1,"text-blue-600"],[3,"click"],[3,"icon"],[1,"btn-blue-nr","bg-green-700","my-3","px-2","ml-1",3,"click"],[1,"bg-white","select-none"],[1,"bg-white","w-full"],[1,"flex","flex-row","justify-end","bg-gray-200","m-3","rounded-md","py-2","text-xs"],[1,"mr-3"],[1,"pt-2","mr-1"],[1,"input-txt","capitalize",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],[1,""],[1,"mt-2.5"],[1,"mt-1","bg-blue-600","rounded-md","px-2","text-white","mx-2","py-1",3,"click"],[1,"mr-1",3,"icon"],[1,"text-sm"],[1,"flex","flex-col","w-full","bg-white","p-3","min-h-96"],[1,"table-auto"],[1,"w-4/12"],[1,"w-2/12"],[1,"w-1/12"],[1,"w-1/12","text-xs"],["class","flex flex-col my-20 text-lg",4,"ngIf"],[3,"meta","movePage",4,"ngIf"],[3,"value"],["class","text-sm",3,"ngClass",4,"ngFor","ngForOf"],[1,"text-sm",3,"ngClass"],[1,"mt-2","mr-3","name-icon","hover:opacity-75",3,"click"],[1,"font-medium","text-gray-900","text-sm","xl:text-lg","select-none"],[1,"text-left","text-xs"],[1,"italic"],[1,"text-center"],[1,"px-2","py-1","text-xs","rounded-full","text-white",3,"ngClass"],[1,"mr-2",3,"icon"],[1,"rounded-md","bg-gray-500","w-14","py-1","text-xs","text-white","hover:opacity-75",3,"click"],[1,"ml-1",3,"icon"],[1,"inline-flex","relative","items-center","cursor-pointer"],["type","checkbox",1,"sr-only","peer",3,"ngModelChange","click","disabled","ngModel"],[1,"w-12","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-blue-300","rounded-full","peer","peer-checked:after:translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:left-[3px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","peer-checked:bg-blue-600","disabled:opacity-7"],["colspan","4",1,"text-center","italic"],[1,"flex","flex-col","my-20","text-lg"],[1,"flex","justify-center","text-center","text-blue-500"],["animation","spin",3,"icon"],[1,"flex","justify-center"],[3,"movePage","meta"],[1,"px-3","py-1","rounded-full","text-sm","text-white","select-none",3,"ngClass"],[3,"selected_user"],[1,"btn-blue","bg-red-500","mr-3","px-10",3,"click","disabled"],["animation","spin",3,"icon",4,"ngIf"],[1,"btn-blue","px-10",3,"click","disabled"]],template:function(n,i){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div"),_(5,Fe,3,1,"span",4),a(6,"span",5),l(7," User Accounts "),p(8,"br"),a(9,"span",6),l(10," Listing of Users, Viewing of User Information, Approving and Rejecting of Pending Accounts, Disabling of Accounts "),r()()(),_(11,Ne,3,1,"div",7),r()(),_(12,qe,46,13,"div",8),a(13,"div",9),_(14,ze,4,7,"div",10)(15,Je,1,1,"app-messaging-sms",11)(16,Ge,1,1,"app-user-information",11)(17,Ze,7,4,"div",12),r()()()),n&2&&(o(5),s("ngIf",i.modals["user-information"]||i.modals["show-sms"]),o(6),s("ngIf",!i.modals["user-information"]||!i.modals["show-sms"]),o(),s("ngIf",!i.modals["user-information"]&&!i.modals["show-sms"]),o(2),M(i.selected_user?14:-1),o(),s("ngIf",i.modals["show-sms"]),o(),s("ngIf",i.modals["user-information"]),o(),M(i.modals["user-information"]&&(i.updating_user||i.selected_user&&i.selected_user.user_verified===null)?17:-1))},dependencies:[$,A,F,D,Y,oe,re,te,ne,P,L,R,H],styles:["td[_ngcontent-%COMP%]{padding:0 5px}"]})}}return t})();var $e=[{path:"",component:he}],ye=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=k({type:t})}static{this.\u0275inj=E({imports:[q.forChild($e),q]})}}return t})();var bt=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=k({type:t})}static{this.\u0275inj=E({imports:[N,ye,X,Y,j,R,H]})}}return t})();export{bt as ManageUserModule};
